---
sidebar_position: 2
sidebar_label: 快速部署
---

## 1. 本地部署

##### 1.创建部署包路径，将DDP按照包拷贝到此目录
在bigdata-ywh-248 执行
```
mkdir -p /opt/datasophon/DDP/packages 
```
拷贝 DDP 安装包到 packages下

![图片1.png](./imgs/图片2.png)

将/data1/opt/datasophon/DDP/packages/datasophon-manager-1.2.3.tar.gz 解压到 /opt/datasophon 目录
```
tar zxvf /opt/datasophon/DDP/packages/datasophon-manager-1.2.3.tar.gz -C /opt/datasophon/
```

解压之后的文件结构如下
```shell
├── bin               # 执行脚本目录
├── conf              # 配置文件目录
├── lib               # 项目依赖目录
├── (logs)            # 日志目录；应用运行后生成
├── jmx               # jmx插件目录
├── datasophon-init   # 环境初始化脚本
├── README.md         # 读我说明
├── Dockerfile        # 容器构建脚本
└── LICENSE
```

##### 2.安装jdk1.8

#每个节点上都执行

```
sudo yum update
java -version
```
#搜索可用的OpenJDK软件包

```
sudo yum search openjdk
```
#安装

```
sudo yum install -y java-1.8.0-openjdk-devel
```

##### 3.在master节点上安装mysql5.7

#添加MySQL 5.7的Yum仓库，并禁用其他版本的默认仓库。

```
sudo rpm -Uvh http://dev.mysql.com/get/mysql57-community-release-el7-9.noarch.rpm
```
#确保安装的是MySQL 5.7版本

```
sudo yum install -y yum-utils
sudo yum-config-manager --disable mysql80-community  # 禁用MySQL 8.0仓库
sudo yum-config-manager --enable mysql57-community   # 启用MySQL 5.7仓库
```
#Yum安装MySQL服务器及相关组件

```
#跳过密钥
sudo yum install --nogpgcheck -y mysql-server 
```
  
#启动MySQL服务并设置开机自启

```
sudo systemctl start mysqld
sudo systemctl enable mysqld
```
#获取初始密码并配置安全设置

```
sudo grep 'temporary password' /var/log/mysqld.log
```
#运行安全配置向导

```
sudo mysql_secure_installation
```
#调整密码策略

```
SET GLOBAL validate_password_policy = 'LOW';
```

创建数据库，添加用户

```
CREATE DATABASE IF NOT EXISTS datasophon DEFAULT CHARACTER SET utf8;
grant all privileges on *.* to datasophon@"%" identified by 'datasophon' with grant option;
GRANT ALL PRIVILEGES ON *.* TO 'datasophon'@'%';
FLUSH PRIVILEGES;
```

##### 4.修改配置文件

```
vim conf/datasophon.conf
datasource.ip=localhost           # 数据库IP或域名
datasource.port=3306              # 数据库端口
datasource.database=datasophon    # 数据库名称
datasource.username=root          # 用户名
datasource.password=root          # 密码
server.port=                      # 服务启动端口(可选)     
```

##### 5.启动DataSophon

```
启动：sh bin/datasophon-api.sh start api
停止：sh bin/datasophon-api.sh stop api
重启：sh bin/datasophon-api.sh restart api 
```
  

部署成功后，可以进行日志查看，日志统一存放于logs文件夹内:
logs/
├── ddh-api.log
├── ddh-api-error.log
|—— api-{hostname}.out

##### 6.访问页面

前端页面：http://ip:8081/ddh

登录的用户名密码：admin/admin123